<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />

		<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
		Remove this if you use the .htaccess -->
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

		<title>index</title>
		<meta name="description" content="" />
		<meta name="author" content="Richard Hildred" />

		<meta name="viewport" content="width=device-width; initial-scale=1.0" />

		<!-- Replace favicon.ico & apple-touch-icon.png in the root of your domain and delete these references -->
		<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="apple-touch-icon" href="/apple-touch-icon.png" />
	</head>

	<body>
		<div>
			<header>
				<h1>index</h1>
			</header>
			<nav>
				<p>
					<a href="/">Home</a>
				</p>
				<p>
					<a href="/contact">Contact</a>
				</p>
			</nav>
			<div id="drop_zone">
				<img id="myimg" src="uploads/nextSteps.gif" />
				Drop files here
			</div>
			<output id="list">
				&nbsp;
			</output>

			<script>

				function uploadFile(myFileObject) {
					// Open Our formData Object
					var formData = new FormData();

					// Append our file to the formData object
					// Notice the first argument "file" and keep it in mind
					formData.append('my_uploaded_file', myFileObject);

					// Create our XMLHttpRequest Object
					var xhr = new XMLHttpRequest();

					// Open our connection using the POST method
					xhr.open("POST", 'upload.php');
					xhr.onreadystatechange = function() {
						if (xhr.readyState == 4 && xhr.status == 200) {
							document.getElementById("myimg").setAttribute('src', "uploads/" + myFileObject.name.replace(".jpg", "_320x300.jpg"));
						}
					}
					// Send the file
					document.getElementById("myimg").setAttribute('src', "uploads/spinner.gif");
					xhr.send(formData);
				}

				function handleFileSelect(evt) {
					evt.stopPropagation();
					evt.preventDefault();

					var files = evt.dataTransfer.files;
					// FileList object.

					// files is a FileList of File objects. List some properties.
					uploadFile(files[0]);
				}

				function handleDragOver(evt) {
					evt.stopPropagation();
					evt.preventDefault();
					evt.dataTransfer.dropEffect = 'copy';
					// Explicitly show this is a copy.
				}

				// Setup the dnd listeners.
				var dropZone = document.getElementById('drop_zone');
				dropZone.addEventListener('dragover', handleDragOver, false);
				dropZone.addEventListener('drop', handleFileSelect, false);

			</script>
			<footer>
				<p>
					&copy; Copyright  by Richard Hildred
				</p>
			</footer>
		</div>
	</body>
</html>
